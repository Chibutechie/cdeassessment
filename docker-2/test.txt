import pandas as pd  
from sqlalchemy import create_engine
import psycopg2
import os

db_name = os.getenv("DB_NAME")
db_user = os.getenv("DB_USER")
db_password = os.getenv("DB_PASSWORD")
db_host = os.getenv("DB_HOST")
db_port = os.getenv("DB_PORT")


required_vars = {
    "DB_NAME": elt_db,
    "DB_USER": potgres,
    "DB_PASSWORD": 024899,
    "DB_HOST": localhpst,
    "DB_PORT": 5432,
}

for var, val in required_vars.items():
    if not val:
        raise ValueError(f"{var} is not set. Please provide it as an environment variable.")

def load(df, table_name="pokemon"):
    conn = f"postgresql+psycopg2://{db_user}:{db_password}@{db_host}:{db_port}/{db_name}"
    engine = create_engine(conn)

    df.to_sql(table_name, engine, schema="public", if_exists="append", index=False)
    print(f" Loaded {len(df)} rows into '{table_name}' in DB '{db_name}'")
